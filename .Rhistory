geom_text(aes(label = round(100 * b_mode_inc$prop, 0),x=b_mode_inc$mode_cats, round(100 * b_mode_inc$prop, 0)), size = 3, position = position_stack(vjust = 0.5, reverse = FALSE), color = "white") +
xlab("") + ylab("Percent of trips") +
scale_fill_manual(values=spectral_scheme) +
theme_minimal() +
coord_flip()
spectral_scheme <- c("#3288BD","#99D594", "#FC8D59","#D53E4F", "#ffd766", "#b5c468" )
ggplot() +
geom_bar(aes(x=b_mode_inc$mode_cats, y=(100 * b_mode_inc$prop), fill=forcats::fct_rev(b_mode_inc$income_cat)), stat="identity", colour="white") +
geom_text(aes(label = round(100 * b_mode_inc$prop, 0),x=b_mode_inc$mode_cats, round(100 * b_mode_inc$prop, 0)), size = 3, position = position_stack(vjust = 0.5, reverse = FALSE), color = "white") +
xlab("") + ylab("Percent of trips") +
scale_fill_manual(values=spectral_scheme) +
theme_minimal() +
coord_flip()
spectral_scheme <- c("#3288BD","#99D594", "#FC8D59","#D53E4F", "#ffd766", "#b5c468" )
spectral_scheme <- c("#D53E4F", "#FC8D59", "#ffd766", "#b5c468", "#99D594", "#3288BD")
ggplot() +
geom_bar(aes(x=b_mode_inc$mode_cats, y=(100 * b_mode_inc$prop), fill=forcats::fct_rev(b_mode_inc$income_cat)), stat="identity", colour="white") +
geom_text(aes(label = round(100 * b_mode_inc$prop, 0),x=b_mode_inc$mode_cats, round(100 * b_mode_inc$prop, 0)), size = 3, position = position_stack(vjust = 0.5, reverse = FALSE), color = "white") +
xlab("") + ylab("Percent of trips") +
scale_fill_manual(values=spectral_scheme) +
theme_minimal() +
coord_flip()
spectral_scheme <- c("#D53E4F", "#FC8D59", "#ffd766", "#9ec975", "#99D594", "#3288BD")
ggplot() +
geom_bar(aes(x=b_mode_inc$mode_cats, y=(100 * b_mode_inc$prop), fill=forcats::fct_rev(b_mode_inc$income_cat)), stat="identity", colour="white") +
geom_text(aes(label = round(100 * b_mode_inc$prop, 0),x=b_mode_inc$mode_cats, round(100 * b_mode_inc$prop, 0)), size = 3, position = position_stack(vjust = 0.5, reverse = FALSE), color = "white") +
xlab("") + ylab("Percent of trips") +
scale_fill_manual(values=spectral_scheme) +
theme_minimal() +
coord_flip()
spectral_scheme <- c("#D53E4F", "#3eab5c", "#ffd766", "#9ec975", "#99D594", "#3288BD")
ggplot() +
geom_bar(aes(x=b_mode_inc$mode_cats, y=(100 * b_mode_inc$prop), fill=forcats::fct_rev(b_mode_inc$income_cat)), stat="identity", colour="white") +
geom_text(aes(label = round(100 * b_mode_inc$prop, 0),x=b_mode_inc$mode_cats, round(100 * b_mode_inc$prop, 0)), size = 3, position = position_stack(vjust = 0.5, reverse = FALSE), color = "white") +
xlab("") + ylab("Percent of trips") +
scale_fill_manual(values=spectral_scheme) +
theme_minimal() +
coord_flip()
spectral_scheme <- c("#D53E4F", "#FC8D59", "#ffd766", "#9ec975", "#3eab5c", "#3288BD")
ggplot() +
geom_bar(aes(x=b_mode_inc$mode_cats, y=(100 * b_mode_inc$prop), fill=forcats::fct_rev(b_mode_inc$income_cat)), stat="identity", colour="white") +
geom_text(aes(label = round(100 * b_mode_inc$prop, 0),x=b_mode_inc$mode_cats, round(100 * b_mode_inc$prop, 0)), size = 3, position = position_stack(vjust = 0.5, reverse = FALSE), color = "white") +
xlab("") + ylab("Percent of trips") +
scale_fill_manual(values=spectral_scheme) +
theme_minimal() +
coord_flip()
spectral_scheme <- rev(c("#D53E4F", "#FC8D59", "#ffd766", "#9ec975", "#3eab5c", "#3288BD"))
ggplot() +
geom_bar(aes(x=b_mode_inc$mode_cats, y=(100 * b_mode_inc$prop), fill=forcats::fct_rev(b_mode_inc$income_cat)), stat="identity", colour="white") +
geom_text(aes(label = round(100 * b_mode_inc$prop, 0),x=b_mode_inc$mode_cats, round(100 * b_mode_inc$prop, 0)), size = 3, position = position_stack(vjust = 0.5, reverse = FALSE), color = "white") +
xlab("") + ylab("Percent of trips") +
scale_fill_manual(values=spectral_scheme) +
theme_minimal() +
coord_flip()
ggplot() +
geom_bar(aes(x=b_mode_inc$mode_cats, y=(100 * b_mode_inc$prop), fill=forcats::fct_rev(b_mode_inc$income_cat)), stat="identity", colour="white", width = 1) +
geom_text(aes(label = round(100 * b_mode_inc$prop, 0),x=b_mode_inc$mode_cats, round(100 * b_mode_inc$prop, 0)), size = 3, position = position_stack(vjust = 0.5, reverse = FALSE), color = "white") +
xlab("") + ylab("Percent of trips") +
scale_fill_manual(values=spectral_scheme) +
theme_minimal() +
coord_flip()
ggplot() +
geom_bar(aes(x=b_mode_inc$mode_cats, y=(100 * b_mode_inc$prop), fill=forcats::fct_rev(b_mode_inc$income_cat)), stat="identity", colour="white", width = 0.5) +
geom_text(aes(label = round(100 * b_mode_inc$prop, 0),x=b_mode_inc$mode_cats, round(100 * b_mode_inc$prop, 0)), size = 3, position = position_stack(vjust = 0.5, reverse = FALSE), color = "white") +
xlab("") + ylab("Percent of trips") +
scale_fill_manual(values=spectral_scheme) +
theme_minimal() +
coord_flip()
spectral_scheme <- rev(c("#D53E4F", "#FC8D59", "#ffd766", "#9ec975", "#3eab5c", "#3288BD"))
ggplot() +
geom_bar(aes(x=b_mode_inc$mode_cats, y=(100 * b_mode_inc$prop), fill=forcats::fct_rev(b_mode_inc$income_cat)), stat="identity", colour="white", width = 0.5) +
geom_text(aes(label = round(100 * b_mode_inc$prop, 0),x=b_mode_inc$mode_cats, round(100 * b_mode_inc$prop, 0)), size = 3, position = position_stack(vjust = 0.5, reverse = FALSE), color = "white") +
xlab("") + ylab("Percent of trips") +
scale_fill_manual(values=spectral_scheme) +
theme_minimal()
ggplot() +
geom_bar(aes(x=b_mode_inc$mode_cats, y=(100 * b_mode_inc$prop), fill=forcats::fct_rev(b_mode_inc$income_cat)), stat="identity", colour="white", width = 0.5) +
geom_text(aes(label = round(100 * b_mode_inc$prop, 0),x=b_mode_inc$mode_cats, round(100 * b_mode_inc$prop, 0)), size = 3, position = position_stack(vjust = 0.5, reverse = FALSE), color = "white") +
xlab("") + ylab("Percent of trips") +
scale_fill_manual(values=spectral_scheme,labels = c("T999", "T888")) +
theme_minimal() +
coord_flip()
ggplot() +
geom_bar(aes(x=b_mode_inc$mode_cats, y=(100 * b_mode_inc$prop), fill=forcats::fct_rev(b_mode_inc$income_cat)), stat="identity", colour="white", width = 0.5) +
geom_text(aes(label = round(100 * b_mode_inc$prop, 0),x=b_mode_inc$mode_cats, round(100 * b_mode_inc$prop, 0)), size = 3, position = position_stack(vjust = 0.5, reverse = FALSE), color = "white") +
xlab("") + ylab("Percent of trips") +
scale_fill_manual(values=spectral_scheme,labels = c("decline / don't know", "$125k + ","100k - 125k", "$60k - 100k", "40k - 60k", "< 40k" )) +
theme_minimal() +
coord_flip()
ggplot() +
geom_bar(aes(x=b_mode_inc$mode_cats, y=(100 * b_mode_inc$prop), fill=forcats::fct_rev(b_mode_inc$income_cat)), stat="identity", colour="white", width = 0.5) +
geom_text(aes(label = round(100 * b_mode_inc$prop, 0),x=b_mode_inc$mode_cats, round(100 * b_mode_inc$prop, 0)), size = 3, position = position_stack(vjust = 0.5, reverse = FALSE), color = "white") +
xlab("") + ylab("Percent of trips") + labs(fill = "Dose (mg)") +
scale_fill_manual(values=spectral_scheme,labels = c("decline / don't know", "$125k + ","100k - 125k", "$60k - 100k", "40k - 60k", "< 40k" )) +
theme_minimal() +
coord_flip()
ggplot() +
geom_bar(aes(x=b_mode_inc$mode_cats, y=(100 * b_mode_inc$prop), fill=forcats::fct_rev(b_mode_inc$income_cat)), stat="identity", colour="white", width = 0.5) +
geom_text(aes(label = round(100 * b_mode_inc$prop, 0),x=b_mode_inc$mode_cats, round(100 * b_mode_inc$prop, 0)), size = 3, position = position_stack(vjust = 0.5, reverse = FALSE), color = "white") +
xlab("") + ylab("Percent of trips") + labs(fill = "Household Income") +
scale_fill_manual(values=spectral_scheme,labels = c("decline / don't know", "$125k + ","100k - 125k", "$60k - 100k", "40k - 60k", "< 40k" )) +
theme_minimal() +
coord_flip()
ggplot() +
geom_bar(aes(x=b_mode_inc$mode_cats, y=(100 * b_mode_inc$prop), fill=forcats::fct_rev(b_mode_inc$income_cat)), stat="identity", colour="white", width = 0.5) +
geom_text(aes(label = round(100 * b_mode_inc$prop, 0),x=b_mode_inc$mode_cats, round(100 * b_mode_inc$prop, 0)), size = 3, position = position_stack(vjust = 0.5, reverse = FALSE), color = "white") +
xlab("Travel Mode") + ylab("Percent of trips") + labs(fill = "Household Income") +
scale_fill_manual(values=spectral_scheme,labels = c("decline / don't know", "$125k + ","100k - 125k", "$60k - 100k", "40k - 60k", "< 40k" )) +
theme_minimal() +
coord_flip()
ggplot() +
geom_bar(aes(x=b_mode_inc$mode_cats, y=(100 * b_mode_inc$prop), fill=forcats::fct_rev(b_mode_inc$income_cat)), stat="identity", colour="white", width = 0.5) +
geom_text(aes(label = round(100 * b_mode_inc$prop, 0),x=b_mode_inc$mode_cats, round(100 * b_mode_inc$prop, 0)), size = 3, position = position_stack(vjust = 0.5, reverse = FALSE), color = "white") +
xlab("Travel Mode") + ylab("Percent of trips") + labs(fill = "Household Income") +
scale_fill_manual(values=spectral_scheme,labels = c("decline / don't know", "$125k + ","100k - 125k", "$60k - 100k", "40k - 60k", "< 40k" )) +
theme_minimal()
ggplot() +
geom_bar(aes(x=b_mode_inc$mode_cats, y=(100 * b_mode_inc$prop), fill=forcats::fct_rev(b_mode_inc$income_cat)), stat="identity", colour="white", width = 0.5) +
geom_text(aes(label = round(100 * b_mode_inc$prop, 0),x=b_mode_inc$mode_cats, round(100 * b_mode_inc$prop, 0)), size = 3, position = position_stack(vjust = 0.5, reverse = FALSE), color = "white") +
xlab("Travel Mode") + ylab("Percent of trips (%)") + labs(fill = "Household Income") +
scale_fill_manual(values=spectral_scheme,labels = c("decline / don't know", "$125k + ","100k - 125k", "$60k - 100k", "40k - 60k", "< 40k" )) +
theme_minimal() +
coord_flip()
ggplot() +
geom_bar(aes(x=b_mode_inc$mode_cats, y=(100 * b_mode_inc$prop), fill=forcats::fct_rev(b_mode_inc$income_cat)), stat="identity", colour="white", width = 0.5) +
geom_text(aes(label = round(100 * b_mode_inc$prop, 0),x=b_mode_inc$mode_cats, round(100 * b_mode_inc$prop, 0)), size = 3, position = position_stack(vjust = 0.5, reverse = FALSE), color = "white") +
xlab("Travel Mode") + ylab("Percent of trips by income group (%)") + labs(fill = "Household Income") +
scale_fill_manual(values=spectral_scheme,labels = c("decline / don't know", "$125k + ","100k - 125k", "$60k - 100k", "40k - 60k", "< 40k" )) +
theme_minimal() +
coord_flip()
ggplot() +
geom_bar(aes(x=b_mode_inc$mode_cats, y=(100 * b_mode_inc$prop), fill=forcats::fct_rev(b_mode_inc$income_cat)), stat="identity", colour="white", width = 0.5) +
geom_text(aes(label = round(100 * b_mode_inc$prop, 0),x=b_mode_inc$mode_cats, round(100 * b_mode_inc$prop, 0)), size = 3, position = position_stack(vjust = 0.5, reverse = FALSE), color = "white") +
xlab("Travel Mode") + ylab("Percent of trips by income group (%)") + labs(fill = "Household Income") +
scale_fill_manual(values=spectral_scheme,labels = c("decline / don't know", "$125k + ","100k - 125k", "$60k - 100k", "40k - 60k", "< 40k" )) +
theme_minimal() +
coord_flip()+ scale_x_reverse()
ggplot() +
geom_bar(aes(x=b_mode_inc$mode_cats, y=(100 * b_mode_inc$prop), fill=forcats::fct_rev(b_mode_inc$income_cat)), stat="identity", colour="white", width = 0.5) +
geom_text(aes(label = round(100 * b_mode_inc$prop, 0),x=b_mode_inc$mode_cats, round(100 * b_mode_inc$prop, 0)), size = 3, position = position_stack(vjust = 0.5, reverse = FALSE), color = "white") +
xlab("Travel Mode") + ylab("Percent of trips by income group (%)") + labs(fill = "Household Income") +
scale_fill_manual(values=spectral_scheme,labels = c("decline / don't know", "$125k + ","100k - 125k", "$60k - 100k", "40k - 60k", "< 40k" )) +
theme_minimal() +
coord_flip() + scale_y_reverse()
ggplot() +
geom_bar(aes(x=b_mode_inc$mode_cats, y=(100 * b_mode_inc$prop), fill=forcats::fct_rev(b_mode_inc$income_cat)), stat="identity", colour="white", width = 0.5) +
geom_text(aes(label = round(100 * b_mode_inc$prop, 0),x=b_mode_inc$mode_cats, round(100 * b_mode_inc$prop, 0)), size = 3, position = position_stack(vjust = 0.5, reverse = FALSE), color = "white") +
xlab("Travel Mode") + ylab("Percent of trips by income group (%)") + labs(fill = "Household Income") +
scale_fill_manual(values=spectral_scheme,labels = c("decline / don't know", "$125k + ","100k - 125k", "$60k - 100k", "40k - 60k", "< 40k" )) +
theme_minimal() +
coord_flip() + scale_y_reverse()
ggplot() +
geom_bar(aes(x=b_mode_inc$mode_cats, y=(100 * b_mode_inc$prop), fill=forcats::fct_rev(b_mode_inc$income_cat)), stat="identity", colour="white", width = 0.5) +
geom_text(aes(label = round(100 * b_mode_inc$prop, 0),x=b_mode_inc$mode_cats, round(100 * b_mode_inc$prop, 0)), size = 3, position = position_stack(vjust = 0.5, reverse = FALSE), color = "white") +
xlab("Travel Mode") + ylab("Percent of trips by income group (%)") + labs(fill = "Household Income") +
scale_fill_manual(values=spectral_scheme,labels = c("decline / don't know", "$125k + ","100k - 125k", "$60k - 100k", "40k - 60k", "< 40k" )) +
theme_minimal() +
coord_flip() + scale_x_reverse()
ggplot() +
geom_bar(aes(x=b_mode_inc$mode_cats, y=(100 * b_mode_inc$prop), fill=forcats::fct_rev(b_mode_inc$income_cat)), stat="identity", colour="white", width = 0.5) +
geom_text(aes(label = round(100 * b_mode_inc$prop, 0),x=b_mode_inc$mode_cats, round(100 * b_mode_inc$prop, 0)), size = 3, position = position_stack(vjust = 0.5, reverse = FALSE), color = "white") +
xlab("Travel Mode") + ylab("Percent of trips by income group (%)") + labs(fill = "Household Income") +
scale_fill_manual(values=spectral_scheme,labels = c("decline / don't know", "$125k + ","100k - 125k", "$60k - 100k", "40k - 60k", "< 40k" )) +
theme_minimal() +
coord_flip()
ggplot() +
geom_bar(aes(x=b_mode_inc$mode_cats, y=(100 * b_mode_inc$prop), fill=forcats::fct_rev(b_mode_inc$income_cat)), stat="identity", colour="white", width = 0.5) +
geom_text(aes(label = round(100 * b_mode_inc$prop, 0),x=b_mode_inc$mode_cats, round(100 * b_mode_inc$prop, 0)), size = 3, position = position_stack(vjust = 0.5, reverse = FALSE), color = "white") +
xlab("Travel Mode") + ylab("Percent of trips by income group (%)") + labs(fill = "Household Income") +
scale_fill_manual(values=spectral_scheme,labels = c("decline / don't know", "$125k + ","100k - 125k", "$60k - 100k", "40k - 60k", "< 40k" )) +
theme_minimal()
ggplot() +
geom_bar(aes(x=b_mode_inc$mode_cats, y=(100 * b_mode_inc$prop), fill=forcats::fct_rev(b_mode_inc$income_cat)), stat="identity", colour="white", width = 0.5) +
geom_text(aes(label = round(100 * b_mode_inc$prop, 0),x=b_mode_inc$mode_cats, round(100 * b_mode_inc$prop, 0)), size = 3, position = position_stack(vjust = 0.5, reverse = FALSE), color = "white") +
xlab("Travel Mode") + ylab("Percent of trips by income group (%)") + labs(fill = "Household Income") +
scale_fill_manual(values=spectral_scheme,labels = c("decline / don't know", "$125k + ","100k - 125k", "$60k - 100k", "40k - 60k", "< 40k" )) +
theme(axis.text.x = element_text(angle=45, hjust=1)) +
theme_minimal()
ggplot() +
geom_bar(aes(x=b_mode_inc$mode_cats, y=(100 * b_mode_inc$prop), fill=forcats::fct_rev(b_mode_inc$income_cat)), stat="identity", colour="white", width = 0.5) +
geom_text(aes(label = round(100 * b_mode_inc$prop, 0),x=b_mode_inc$mode_cats, round(100 * b_mode_inc$prop, 0)), size = 3, position = position_stack(vjust = 0.5, reverse = FALSE), color = "white") +
xlab("Travel Mode") + ylab("Percent of trips by income group (%)") + labs(fill = "Household Income") +
scale_fill_manual(values=spectral_scheme,labels = c("decline / don't know", "$125k + ","100k - 125k", "$60k - 100k", "40k - 60k", "< 40k" ))  +
theme_minimal() +
theme(axis.text.x = element_text(angle=45, hjust=1))
bincome <- df %>%
group_by(income_cat) %>%
summarise(
total = sum(N)
)
bincome
b_inc_mode <- inner_join(b_mode_inc, bincome, by = "mode_cats")
b_inc_mode <- inner_join(b_mode_inc, bincome, by = "income_cat")
b_inc_mode$prop <- b_inc_mode$total.x / b_inc_mode$total.y
b_inc_mode
b_inc_mode$prop <- b_inc_mode$total.x / b_inc_mode$total
b_inc_mode
ggplot() +
geom_bar(aes(x=b_inc_mode$income_cat, y=(100 * b_inc_mode$prop), fill=forcats::fct_rev(b_inc_mode$mode_cats)), stat="identity", colour="white", width = 0.5)
ggplot() +
geom_bar(aes(x=b_inc_mode$income_cat, y=(100 * b_inc_mode$prop), fill=forcats::fct_rev(b_inc_mode$mode_cats)), stat="identity", colour="white", width = 0.5) +
geom_text(aes(label = round(100 * b_inc_mode$prop, 0),x=b_inc_mode$income_cat, round(100 * b_inc_mode$prop, 0)), size = 3, position = position_stack(vjust = 0.5, reverse = FALSE), color = "white")
ggplot() +
geom_bar(aes(x=b_inc_mode$income_cat, y=(100 * b_inc_mode$prop), fill=forcats::fct_rev(b_inc_mode$mode_cats)), stat="identity", colour="white", width = 0.5) +
geom_text(aes(label = round(100 * b_inc_mode$prop, 0),x=b_inc_mode$income_cat, round(100 * b_inc_mode$prop, 0)), size = 3, position = position_stack(vjust = 0.5, reverse = FALSE), color = "white") +
xlab("Household Income") + ylab("Percent of Trips Travel Mode (%)") + labs(fill = "Travel Mode")
ggplot() +
geom_bar(aes(x=b_inc_mode$income_cat, y=(100 * b_inc_mode$prop), fill=forcats::fct_rev(b_inc_mode$mode_cats)), stat="identity", colour="white", width = 0.5) +
geom_text(aes(label = round(100 * b_inc_mode$prop, 0),x=b_inc_mode$income_cat, round(100 * b_inc_mode$prop, 0)), size = 3, position = position_stack(vjust = 0.5, reverse = FALSE), color = "white") +
xlab("Household Income") + ylab("Percent of Trips Travel Mode (%)") + labs(fill = "Travel Mode") +
scale_fill_manual(values=spectral_scheme,labels = c("decline / don't know", "$125k + ","100k - 125k", "$60k - 100k", "40k - 60k", "< 40k" ))  +
theme_minimal() +
theme(axis.text.x = element_text(angle=45, hjust=1))
ggplot() +
geom_bar(aes(x=b_inc_mode$income_cat, y=(100 * b_inc_mode$prop), fill=forcats::fct_rev(b_inc_mode$mode_cats)), stat="identity", colour="white", width = 0.5) +
geom_text(aes(label = round(100 * b_inc_mode$prop, 0),x=b_inc_mode$income_cat, round(100 * b_inc_mode$prop, 0)), size = 3, position = position_stack(vjust = 0.5, reverse = FALSE), color = "white")
ggplot() +
geom_bar(aes(x=b_inc_mode$income_cat, y=(100 * b_inc_mode$prop), fill=forcats::fct_rev(b_inc_mode$mode_cats)), stat="identity", colour="white", width = 0.5) +
geom_text(aes(label = round(100 * b_inc_mode$prop, 0),x=b_inc_mode$income_cat, round(100 * b_inc_mode$prop, 0)), size = 3, position = position_stack(vjust = 0.5, reverse = FALSE), color = "white") +
xlab("Household Income") + ylab("Percent of Trips Travel Mode (%)") + labs(fill = "Travel Mode") +
theme_minimal() +
theme(axis.text.x = element_text(angle=45, hjust=1))
ggplot() +
geom_bar(aes(x=b_inc_mode$income_cat, y=(100 * b_inc_mode$prop), fill=forcats::fct_rev(b_inc_mode$mode_cats)), stat="identity", colour="white", width = 0.5) +
geom_text(aes(label = round(100 * b_inc_mode$prop, 0),x=b_inc_mode$income_cat, round(100 * b_inc_mode$prop, 0)), size = 3, position = position_stack(vjust = 0.5, reverse = FALSE), color = "white") +
xlab("Household Income") + ylab("Percent of Trips Travel Mode (%)") + labs(fill = "Travel Mode") +
theme_minimal() +
theme(axis.text.x = element_text(angle=45, hjust=1))
ggplot() +
geom_bar(aes(x=b_inc_mode$income_cat, y=(100 * b_inc_mode$prop), fill=forcats::fct_rev(b_inc_mode$mode_cats)), stat="identity", colour="white", width = 0.5) +
geom_text(aes(label = round(100 * b_inc_mode$prop, 0),x=b_inc_mode$income_cat, round(100 * b_inc_mode$prop, 0)), size = 3, position = position_stack(vjust = 0.5, reverse = FALSE), color = "white") +
xlab("Household Income") + ylab("Percent of Trips Travel Mode (%)") + labs(fill = "Travel Mode") +
scale_x_manual(values=spectral_scheme,labels = c("decline / don't know", "$125k + ","100k - 125k", "$60k - 100k", "40k - 60k", "< 40k" )) +
theme_minimal() +
theme(axis.text.x = element_text(angle=45, hjust=1))
ggplot() +
geom_bar(aes(x=b_inc_mode$income_cat, y=(100 * b_inc_mode$prop), fill=forcats::fct_rev(b_inc_mode$mode_cats)), stat="identity", colour="white", width = 0.5) +
geom_text(aes(label = round(100 * b_inc_mode$prop, 0),x=b_inc_mode$income_cat, round(100 * b_inc_mode$prop, 0)), size = 3, position = position_stack(vjust = 0.5, reverse = FALSE), color = "white") +
xlab("Household Income") + ylab("Percent of Trips Travel Mode (%)") + labs(fill = "Travel Mode") +
scale_x_discrete(values=spectral_scheme,labels = c("decline / don't know", "$125k + ","100k - 125k", "$60k - 100k", "40k - 60k", "< 40k" )) +
theme_minimal() +
theme(axis.text.x = element_text(angle=45, hjust=1))
ggplot() +
geom_bar(aes(x=b_inc_mode$income_cat, y=(100 * b_inc_mode$prop), fill=forcats::fct_rev(b_inc_mode$mode_cats)), stat="identity", colour="white", width = 0.5) +
geom_text(aes(label = round(100 * b_inc_mode$prop, 0),x=b_inc_mode$income_cat, round(100 * b_inc_mode$prop, 0)), size = 3, position = position_stack(vjust = 0.5, reverse = FALSE), color = "white") +
xlab("Household Income") + ylab("Percent of Trips Travel Mode (%)") + labs(fill = "Travel Mode") +
scale_x_discrete(labels = c("decline / don't know", "$125k + ","100k - 125k", "$60k - 100k", "40k - 60k", "< 40k" )) +
theme_minimal() +
theme(axis.text.x = element_text(angle=45, hjust=1))
ggplot() +
geom_bar(aes(x=b_inc_mode$income_cat, y=(100 * b_inc_mode$prop), fill=forcats::fct_rev(b_inc_mode$mode_cats)), stat="identity", colour="white", width = 0.5) +
geom_text(aes(label = round(100 * b_inc_mode$prop, 0),x=b_inc_mode$income_cat, round(100 * b_inc_mode$prop, 0)), size = 3, position = position_stack(vjust = 0.5, reverse = FALSE), color = "white") +
xlab("Household Income") + ylab("Percent of Trips Travel Mode (%)") + labs(fill = "Travel Mode") +
scale_x_discrete(labels = rev(c("decline / don't know", "$125k + ","100k - 125k", "$60k - 100k", "40k - 60k", "< 40k" ))) +
theme_minimal() +
theme(axis.text.x = element_text(angle=45, hjust=1))
ggplot() +
geom_bar(aes(x=b_mode_inc$mode_cats, y=(100 * b_mode_inc$prop), fill=forcats::fct_rev(b_mode_inc$income_cat)), stat="identity", colour="white", width = 0.5) +
geom_text(aes(label = round(100 * b_mode_inc$prop, 0),x=b_mode_inc$mode_cats, round(100 * b_mode_inc$prop, 0)), size = 3, position = position_stack(vjust = 0.5, reverse = FALSE), color = "white") +
xlab("Travel Mode") + ylab("Percent of trips by income group (%)") + labs(fill = "Household Income") +
scale_fill_manual(values=spectral_scheme,labels = c("decline / don't know", "$125k + ","100k - 125k", "$60k - 100k", "40k - 60k", "< 40k" ))  +
theme_minimal() +
theme(axis.text.x = element_text(angle=45, hjust=1))
ggplot() +
geom_bar(aes(x=b_inc_mode$income_cat, y=(100 * b_inc_mode$prop), fill=forcats::fct_rev(b_inc_mode$mode_cats)), stat="identity", colour="white", width = 0.5) +
geom_text(aes(label = round(100 * b_inc_mode$prop, 0),x=b_inc_mode$income_cat, round(100 * b_inc_mode$prop, 0)), size = 3, position = position_stack(vjust = 0.5, reverse = FALSE), color = "white") +
xlab("Household Income") + ylab("Percent of Trips Travel Mode (%)") + labs(fill = "Travel Mode") +
scale_x_discrete(labels = rev(c("decline / don't know", "$125k + ","100k - 125k", "$60k - 100k", "40k - 60k", "< 40k" ))) +
theme_minimal() +
theme(axis.text.x = element_text(angle=45, hjust=1))
ggplot() +
geom_bar(aes(x=b_inc_mode$income_cat, y=(100 * b_inc_mode$prop), fill=forcats::fct_rev(b_inc_mode$mode_cats)), stat="identity", colour="white", width = 0.5) +
geom_text(aes(label = round(100 * b_inc_mode$prop, 0),x=b_inc_mode$income_cat, round(100 * b_inc_mode$prop, 0)), size = 3, position = position_stack(vjust = 0.5, reverse = FALSE), color = "white") +
xlab("Household Income") + ylab("Percent of Trips Travel Mode (%)") + labs(fill = "Travel Mode") +
scale_x_discrete(labels = rev(c("decline / don't know", "$125k + ","100k - 125k", "$60k - 100k", "40k - 60k", "< 40k" ))) +
scale_y_continuous(limits = c(50,100)) +
theme_minimal() +
theme(axis.text.x = element_text(angle=45, hjust=1))
ggplot() +
geom_bar(aes(x=b_inc_mode$income_cat, y=(100 * b_inc_mode$prop), fill=forcats::fct_rev(b_inc_mode$mode_cats)), stat="identity", colour="white", width = 0.5) +
geom_text(aes(label = round(100 * b_inc_mode$prop, 0),x=b_inc_mode$income_cat, round(100 * b_inc_mode$prop, 0)), size = 3, position = position_stack(vjust = 0.5, reverse = FALSE), color = "white") +
xlab("Household Income") + ylab("Percent of Trips Travel Mode (%)") + labs(fill = "Travel Mode") +
scale_x_discrete(labels = rev(c("decline / don't know", "$125k + ","100k - 125k", "$60k - 100k", "40k - 60k", "< 40k" ))) +
scale_y_continuous(limits = c(0.5,1)) +
theme_minimal() +
theme(axis.text.x = element_text(angle=45, hjust=1))
ggplot() +
geom_bar(aes(x=b_inc_mode$income_cat, y=(100 * b_inc_mode$prop), fill=forcats::fct_rev(b_inc_mode$mode_cats)), stat="identity", colour="white", width = 0.5) +
geom_text(aes(label = round(100 * b_inc_mode$prop, 0),x=b_inc_mode$income_cat, round(100 * b_inc_mode$prop, 0)), size = 3, position = position_stack(vjust = 0.5, reverse = FALSE), color = "white") +
xlab("Household Income") + ylab("Percent of Trips Travel Mode (%)") + labs(fill = "Travel Mode") +
scale_x_discrete(labels = rev(c("decline / don't know", "$125k + ","100k - 125k", "$60k - 100k", "40k - 60k", "< 40k" ))) +
scale_y_continuous(limits = c(0,1)) +
theme_minimal() +
theme(axis.text.x = element_text(angle=45, hjust=1))
ggplot() +
geom_bar(aes(x=b_inc_mode$income_cat, y=(100 * b_inc_mode$prop), (b_inc_mode$mode_cats)), stat="identity", colour="white", width = 0.5) +
geom_text(aes(label = round(100 * b_inc_mode$prop, 0),x=b_inc_mode$income_cat, round(100 * b_inc_mode$prop, 0)), size = 3, position = position_stack(vjust = 0.5, reverse = FALSE), color = "white") +
xlab("Household Income") + ylab("Percent of Trips Travel Mode (%)") + labs(fill = "Travel Mode") +
scale_x_discrete(labels = rev(c("decline / don't know", "$125k + ","100k - 125k", "$60k - 100k", "40k - 60k", "< 40k" ))) +
scale_y_continuous(limits = c(0,1)) +
theme_minimal() +
theme(axis.text.x = element_text(angle=45, hjust=1))
ggplot() +
geom_bar(aes(x=b_inc_mode$income_cat, y=(100 * b_inc_mode$prop), fill=(b_inc_mode$mode_cats)), stat="identity", colour="white", width = 0.5) +
geom_text(aes(label = round(100 * b_inc_mode$prop, 0),x=b_inc_mode$income_cat, round(100 * b_inc_mode$prop, 0)), size = 3, position = position_stack(vjust = 0.5, reverse = FALSE), color = "white") +
xlab("Household Income") + ylab("Percent of Trips Travel Mode (%)") + labs(fill = "Travel Mode") +
scale_x_discrete(labels = rev(c("decline / don't know", "$125k + ","100k - 125k", "$60k - 100k", "40k - 60k", "< 40k" ))) +
scale_y_continuous(limits = c(0,1)) +
theme_minimal() +
theme(axis.text.x = element_text(angle=45, hjust=1))
ggplot() +
geom_bar(aes(x=b_inc_mode$income_cat, y=(100 * b_inc_mode$prop), fill=(b_inc_mode$mode_cats)), stat="identity", colour="white", width = 0.5) +
geom_text(aes(label = round(100 * b_inc_mode$prop, 0),x=b_inc_mode$income_cat, round(100 * b_inc_mode$prop, 0)), size = 3, position = position_stack(vjust = 0.5, reverse = FALSE), color = "white") +
xlab("Household Income") + ylab("Percent of Trips Travel Mode (%)") + labs(fill = "Travel Mode") +
scale_x_discrete(labels = rev(c("decline / don't know", "$125k + ","100k - 125k", "$60k - 100k", "40k - 60k", "< 40k" ))) +
scale_y_continuous(limits = c(50,100)) +
theme_minimal() +
theme(axis.text.x = element_text(angle=45, hjust=1))
ggplot() +
geom_bar(aes(x=b_inc_mode$income_cat, y=(100 * b_inc_mode$prop), fill=forcats::fct_rev(b_inc_mode$mode_cats)), stat="identity", colour="white", width = 0.5) +
geom_text(aes(label = round(100 * b_inc_mode$prop, 0),x=b_inc_mode$income_cat, round(100 * b_inc_mode$prop, 0)), size = 3, position = position_stack(vjust = 0.5, reverse = FALSE), color = "white") +
xlab("Household Income") + ylab("Percent of Trips Travel Mode (%)") + labs(fill = "Travel Mode") +
scale_x_discrete(labels = rev(c("decline / don't know", "$125k + ","100k - 125k", "$60k - 100k", "40k - 60k", "< 40k" ))) +
# scale_y_continuous(limits = c(0,1)) +
theme_minimal() +
theme(axis.text.x = element_text(angle=45, hjust=1))
ggplot() +
geom_bar(aes(x=b_inc_mode$income_cat, y=(100 * b_inc_mode$prop), fill=forcats::fct_rev(b_inc_mode$mode_cats)), stat="identity", colour="white", width = 0.5) +
geom_text(aes(label = round(100 * b_inc_mode$prop, 0),x=b_inc_mode$income_cat, round(100 * b_inc_mode$prop, 0)), size = 3, position = position_stack(vjust = 0.5, reverse = FALSE), color = "white") +
xlab("Household Income") + ylab("Percent of Trips Travel Mode (%)") + labs(fill = "Travel Mode") +
scale_x_discrete(labels = rev(c("decline / don't know", "$125k + ","100k - 125k", "$60k - 100k", "40k - 60k", "< 40k" ))) +
scale_y_continuous(limits = c(0,150)) +
theme_minimal() +
theme(axis.text.x = element_text(angle=45, hjust=1))
ggplot() +
geom_bar(aes(x=b_inc_mode$income_cat, y=(100 * b_inc_mode$prop), fill=forcats::fct_rev(b_inc_mode$mode_cats)), stat="identity", colour="white", width = 0.5) +
geom_text(aes(label = round(100 * b_inc_mode$prop, 0),x=b_inc_mode$income_cat, round(100 * b_inc_mode$prop, 0)), size = 3, position = position_stack(vjust = 0.5, reverse = FALSE), color = "white") +
xlab("Household Income") + ylab("Percent of Trips Travel Mode (%)") + labs(fill = "Travel Mode") +
scale_x_discrete(labels = rev(c("decline / don't know", "$125k + ","100k - 125k", "$60k - 100k", "40k - 60k", "< 40k" ))) +
scale_y_continuous(limits = c(0,100)) +
theme_minimal() +
theme(axis.text.x = element_text(angle=45, hjust=1))
ggplot() +
geom_bar(aes(x=b_inc_mode$income_cat, y=(100 * b_inc_mode$prop), fill=forcats::fct_rev(b_inc_mode$mode_cats)), stat="identity", colour="white", width = 0.5) +
geom_text(aes(label = round(100 * b_inc_mode$prop, 0),x=b_inc_mode$income_cat, round(100 * b_inc_mode$prop, 0)), size = 3, position = position_stack(vjust = 0.5, reverse = FALSE), color = "white") +
xlab("Household Income") + ylab("Percent of Trips Travel Mode (%)") + labs(fill = "Travel Mode") +
scale_x_discrete(labels = rev(c("decline / don't know", "$125k + ","100k - 125k", "$60k - 100k", "40k - 60k", "< 40k" ))) +
scale_y_continuous(limits = c(50,100)) +
theme_minimal() +
theme(axis.text.x = element_text(angle=45, hjust=1))
ggplot() +
geom_bar(aes(x=b_inc_mode$income_cat, y=(100 * b_inc_mode$prop), fill=forcats::fct_rev(b_inc_mode$mode_cats)), stat="identity", colour="white", width = 0.5) +
geom_text(aes(label = round(100 * b_inc_mode$prop, 0),x=b_inc_mode$income_cat, round(100 * b_inc_mode$prop, 0)), size = 3, position = position_stack(vjust = 0.5, reverse = FALSE), color = "white") +
xlab("Household Income") + ylab("Percent of Trips Travel Mode (%)") + labs(fill = "Travel Mode") +
scale_x_discrete(labels = rev(c("decline / don't know", "$125k + ","100k - 125k", "$60k - 100k", "40k - 60k", "< 40k" ))) +
scale_y_continuous(limits = c(40,100)) +
theme_minimal() +
theme(axis.text.x = element_text(angle=45, hjust=1))
ggplot() +
geom_bar(aes(x=b_inc_mode$income_cat, y=(100 * b_inc_mode$prop), fill=forcats::fct_rev(b_inc_mode$mode_cats)), stat="identity", colour="white", width = 0.5) +
geom_text(aes(label = round(100 * b_inc_mode$prop, 0),x=b_inc_mode$income_cat, round(100 * b_inc_mode$prop, 0)), size = 3, position = position_stack(vjust = 0.5, reverse = FALSE), color = "white") +
xlab("Household Income") + ylab("Percent of Trips Travel Mode (%)") + labs(fill = "Travel Mode") +
scale_x_discrete(labels = rev(c("decline / don't know", "$125k + ","100k - 125k", "$60k - 100k", "40k - 60k", "< 40k" ))) +
scale_y_continuous(limits = c(0,100)) +
theme_minimal() +
theme(axis.text.x = element_text(angle=45, hjust=1))
ggplot() +
geom_bar(aes(x=b_inc_mode$income_cat, y=(100 * b_inc_mode$prop), fill=forcats::fct_rev(b_inc_mode$mode_cats)), stat="identity", colour="white", width = 0.5) +
geom_text(aes(label = round(100 * b_inc_mode$prop, 0),x=b_inc_mode$income_cat, round(100 * b_inc_mode$prop, 0)), size = 3, position = position_stack(vjust = 0.5, reverse = FALSE), color = "white") +
xlab("Household Income") + ylab("Percent of Trips Travel Mode (%)") + labs(fill = "Travel Mode") +
scale_x_discrete(labels = rev(c("decline / don't know", "$125k + ","100k - 125k", "$60k - 100k", "40k - 60k", "< 40k" ))) +
scale_y_continuous(limits = c(0,100)) +
theme_minimal() +
theme(axis.text.x = element_text(angle=45, hjust=1)) + coord_flip()
temp <- subset(b_inc_mode,b_inc_mode$mode_cats == "Bicycle")
ggplot() + geom_bar(aes(x=temp$income_cat, y=(100 * temp$prop), fill=forcats::fct_rev(temp$mode_cats)), stat="identity", colour="white", width = 0.5)
ggplot() + geom_bar(aes(x=temp$income_cat, y=(100 * temp$prop), fill=forcats::fct_rev(temp$mode_cats)), stat="identity", colour="white", width = 0.5) +
scale_x_discrete(labels = rev(c("decline / don't know", "$125k + ","100k - 125k", "$60k - 100k", "40k - 60k", "< 40k" ))) +
theme_minimal() +
theme(axis.text.x = element_text(angle=45, hjust=1)) + coord_flip()
ggplot() + geom_bar(aes(x=temp$income_cat, y=(100 * temp$prop), fill=forcats::fct_rev(temp$mode_cats)), stat="identity", colour="white", width = 0.5) +
scale_x_discrete(labels = rev(c("decline / don't know", "$125k + ","100k - 125k", "$60k - 100k", "40k - 60k", "< 40k" ))) +
theme_minimal() +
theme(axis.text.x = element_text(angle=45, hjust=1))
ggplot() + geom_bar(aes(x=temp$income_cat, y=(100 * temp$prop), fill=forcats::fct_rev(temp$mode_cats)), stat="identity", colour="white", width = 0.5) +
xlab("Household Income") + ylab("Percent of Trips by Bicycle (%)") + labs(fill = "Travel Mode") +
scale_x_discrete(labels = rev(c("decline / don't know", "$125k + ","100k - 125k", "$60k - 100k", "40k - 60k", "< 40k" ))) +
theme_minimal() +
theme(axis.text.x = element_text(angle=45, hjust=1))
temp <- subset(b_inc_mode,b_inc_mode$mode_cats == "Walk")
pw <- ggplot() + geom_bar(aes(x=temp$income_cat, y=(100 * temp$prop), fill=forcats::fct_rev(temp$mode_cats)), stat="identity", colour="white", width = 0.5) +
xlab("Household Income") + ylab("Percent of Trips by Bicycle (%)") + labs(fill = "Travel Mode") +
scale_x_discrete(labels = rev(c("decline / don't know", "$125k + ","100k - 125k", "$60k - 100k", "40k - 60k", "< 40k" ))) +
theme_minimal() +
theme(axis.text.x = element_text(angle=45, hjust=1))
pw
temp <- subset(b_inc_mode,b_inc_mode$mode_cats == "Transit (Public)" & b_inc_mode$mode_cats == "Transit (GO)" & b_inc_mode$mode_cats == "Transit (Public & GO)")
temp <- subset(b_inc_mode,b_inc_mode$mode_cats == "Transit (Public)" & b_inc_mode$mode_cats == "Transit (GO)" & b_inc_mode$mode_cats == "Transit (Public & GO)")
temp
b_inc_mode
b_inc_mode$mode_cats
temp <- subset(b_inc_mode, (b_inc_mode$mode_cats == "Transit (Public)" | b_inc_mode$mode_cats == "Transit (GO)" | b_inc_mode$mode_cats == "Transit (Public & GO)"))
pt <- ggplot() + geom_bar(aes(x=temp$income_cat, y=(100 * temp$prop), fill=forcats::fct_rev(temp$mode_cats)), stat="identity", colour="white", width = 0.5) +
xlab("Household Income") + ylab("Percent of Trips by Walking (%)") + labs(fill = "Travel Mode") +
scale_x_discrete(labels = rev(c("decline / don't know", "$125k + ","100k - 125k", "$60k - 100k", "40k - 60k", "< 40k" ))) +
theme_minimal() +
theme(axis.text.x = element_text(angle=45, hjust=1))
pt
temp <- subset(b_inc_mode, (b_inc_mode$mode_cats == "Auto Driver" | b_inc_mode$mode_cats == "Auto Passenger"))
pd <- ggplot() + geom_bar(aes(x=temp$income_cat, y=(100 * temp$prop), fill=forcats::fct_rev(temp$mode_cats)), stat="identity", colour="white", width = 0.5) +
xlab("Household Income") + ylab("Percent of Trips by Walking (%)") + labs(fill = "Travel Mode") +
scale_x_discrete(labels = rev(c("decline / don't know", "$125k + ","100k - 125k", "$60k - 100k", "40k - 60k", "< 40k" ))) +
theme_minimal() +
theme(axis.text.x = element_text(angle=45, hjust=1))
pd
temp <- subset(b_inc_mode,b_inc_mode$mode_cats == "Bicycle")
pb <- ggplot() + geom_bar(aes(x=temp$income_cat, y=(100 * temp$prop), fill=forcats::fct_rev(temp$mode_cats)), stat="identity", colour="white", width = 0.5) +
xlab("Household Income") + ylab("Percent of Trips by Bicycle (%)") + labs(fill = "Travel Mode") +
scale_x_discrete(labels = rev(c("decline / don't know", "$125k + ","100k - 125k", "$60k - 100k", "40k - 60k", "< 40k" ))) +
theme_minimal() +
theme(axis.text.x = element_text(angle=45, hjust=1))
temp <- subset(b_inc_mode,b_inc_mode$mode_cats == "Walk")
pw <- ggplot() + geom_bar(aes(x=temp$income_cat, y=(100 * temp$prop), fill=forcats::fct_rev(temp$mode_cats)), stat="identity", colour="white", width = 0.5) +
xlab("Household Income") + ylab("Percent of Trips by Walking (%)") + labs(fill = "Travel Mode") +
scale_x_discrete(labels = rev(c("decline / don't know", "$125k + ","100k - 125k", "$60k - 100k", "40k - 60k", "< 40k" ))) +
theme_minimal() +
theme(axis.text.x = element_text(angle=45, hjust=1))
temp <- subset(b_inc_mode, (b_inc_mode$mode_cats == "Transit (Public)" | b_inc_mode$mode_cats == "Transit (GO)" | b_inc_mode$mode_cats == "Transit (Public & GO)"))
pt <- ggplot() + geom_bar(aes(x=temp$income_cat, y=(100 * temp$prop), fill=forcats::fct_rev(temp$mode_cats)), stat="identity", colour="white", width = 0.5) +
xlab("Household Income") + ylab("Percent of Trips by Transit (%)") + labs(fill = "Travel Mode") +
scale_x_discrete(labels = rev(c("decline / don't know", "$125k + ","100k - 125k", "$60k - 100k", "40k - 60k", "< 40k" ))) +
theme_minimal() +
theme(axis.text.x = element_text(angle=45, hjust=1))
temp <- subset(b_inc_mode, (b_inc_mode$mode_cats == "Auto Driver" | b_inc_mode$mode_cats == "Auto Passenger"))
pd <- ggplot() + geom_bar(aes(x=temp$income_cat, y=(100 * temp$prop), fill=forcats::fct_rev(temp$mode_cats)), stat="identity", colour="white", width = 0.5) +
xlab("Household Income") + ylab("Percent of Trips by Driving (%)") + labs(fill = "Travel Mode") +
scale_x_discrete(labels = rev(c("decline / don't know", "$125k + ","100k - 125k", "$60k - 100k", "40k - 60k", "< 40k" ))) +
theme_minimal() +
theme(axis.text.x = element_text(angle=45, hjust=1))
pt
pt
pw
temp <- subset(b_inc_mode,b_inc_mode$mode_cats == "Bicycle")
pb <- ggplot() + geom_bar(aes(x=temp$income_cat, y=(100 * temp$prop), fill=forcats::fct_rev(temp$mode_cats)), stat="identity", colour="white", width = 0.5) +
xlab("Household Income") + ylab("Percent of Trips by Bicycle (%)") + labs(fill = "Travel Mode") +
scale_x_discrete(labels = rev(c("decline / don't know", "$125k + ","100k - 125k", "$60k - 100k", "40k - 60k", "< 40k" ))) +
theme_minimal() +
theme(axis.text.x = element_text(angle=45, hjust=1))
temp <- subset(b_inc_mode,b_inc_mode$mode_cats == "Walk")
pw <- ggplot() + geom_bar(aes(x=temp$income_cat, y=(100 * temp$prop), fill=forcats::fct_rev(temp$mode_cats)), stat="identity", colour="white", width = 0.5) +
xlab("Household Income") + ylab("Percent of Trips by Walking (%)") + labs(fill = "Travel Mode") +
scale_x_discrete(labels = rev(c("decline / don't know", "$125k + ","100k - 125k", "$60k - 100k", "40k - 60k", "< 40k" ))) +
theme_minimal() +
theme(axis.text.x = element_text(angle=45, hjust=1))
temp <- subset(b_inc_mode, (b_inc_mode$mode_cats == "Transit (Public)" | b_inc_mode$mode_cats == "Transit (GO)" | b_inc_mode$mode_cats == "Transit (Public & GO)"))
pt <- ggplot() + geom_bar(aes(x=temp$income_cat, y=(100 * temp$prop), fill=forcats::fct_rev(temp$mode_cats)), stat="identity", colour="white", width = 0.5) +
xlab("Household Income") + ylab("Percent of Trips by Transit (%)") + labs(fill = "Travel Mode") +
scale_x_discrete(labels = rev(c("decline / don't know", "$125k + ","100k - 125k", "$60k - 100k", "40k - 60k", "< 40k" ))) +
theme_minimal() +
theme(axis.text.x = element_text(angle=45, hjust=1))
pt
pw
temp <- subset(b_inc_mode,b_inc_mode$mode_cats == "Bicycle" | b_inc_mode$mode_cats == "Walk")
pa <- ggplot() + geom_bar(aes(x=temp$income_cat, y=(100 * temp$prop), fill=forcats::fct_rev(temp$mode_cats)), stat="identity", colour="white", width = 0.5) +
xlab("Household Income") + ylab("Percent of Trips by Bicycle (%)") + labs(fill = "Travel Mode") +
scale_x_discrete(labels = rev(c("decline / don't know", "$125k + ","100k - 125k", "$60k - 100k", "40k - 60k", "< 40k" ))) +
theme_minimal() +
theme(axis.text.x = element_text(angle=45, hjust=1))
pa
temp <- subset(b_inc_mode,b_inc_mode$mode_cats == "Bicycle" | b_inc_mode$mode_cats == "Walk")
pa <- ggplot() + geom_bar(aes(x=temp$income_cat, y=(100 * temp$prop), fill=forcats::fct_rev(temp$mode_cats)), stat="identity", colour="white", width = 0.5) +
xlab("Household Income") + ylab("Percent of Trips by Active Modes (%)") + labs(fill = "Travel Mode") +
scale_x_discrete(labels = rev(c("decline / don't know", "$125k + ","100k - 125k", "$60k - 100k", "40k - 60k", "< 40k" ))) +
theme_minimal() +
theme(axis.text.x = element_text(angle=45, hjust=1))
temp <- subset(b_inc_mode, (b_inc_mode$mode_cats == "Transit (Public)" | b_inc_mode$mode_cats == "Transit (GO)" | b_inc_mode$mode_cats == "Transit (Public & GO)"))
pt <- ggplot() + geom_bar(aes(x=temp$income_cat, y=(100 * temp$prop), fill=forcats::fct_rev(temp$mode_cats)), stat="identity", colour="white", width = 0.5) +
xlab("Household Income") + ylab("Percent of Trips by Transit (%)") + labs(fill = "Travel Mode") +
scale_x_discrete(labels = rev(c("decline / don't know", "$125k + ","100k - 125k", "$60k - 100k", "40k - 60k", "< 40k" ))) +
theme_minimal() +
theme(axis.text.x = element_text(angle=45, hjust=1))
temp <- subset(b_inc_mode, (b_inc_mode$mode_cats == "Auto Driver" | b_inc_mode$mode_cats == "Auto Passenger"))
pd <- ggplot() + geom_bar(aes(x=temp$income_cat, y=(100 * temp$prop), fill=forcats::fct_rev(temp$mode_cats)), stat="identity", colour="white", width = 0.5) +
xlab("Household Income") + ylab("Percent of Trips by Driving (%)") + labs(fill = "Travel Mode") +
scale_x_discrete(labels = rev(c("decline / don't know", "$125k + ","100k - 125k", "$60k - 100k", "40k - 60k", "< 40k" ))) +
theme_minimal() +
theme(axis.text.x = element_text(angle=45, hjust=1))
pt
pt
temp <- subset(b_inc_mode, (b_inc_mode$mode_cats == "Transit (Public)" | b_inc_mode$mode_cats == "Transit (GO)" | b_inc_mode$mode_cats == "Transit (Public & GO)"))
pt <- ggplot() + geom_bar(aes(x=temp$income_cat, y=(100 * temp$prop), fill=forcats::fct_rev(temp$mode_cats)), stat="identity", colour="white", width = 0.5) +
xlab("Household Income") + ylab("Percent of Trips by Transit (%)") + labs(fill = "Travel Mode") +
scale_x_discrete(labels = rev(c("decline / don't know", "$125k + ","100k - 125k", "$60k - 100k", "40k - 60k", "< 40k" ))) +
theme_minimal() +
theme(axis.text.x = element_text(angle=45, hjust=1))
pt
pd
temp <- subset(b_inc_mode, (b_inc_mode$mode_cats == "Auto Driver" | b_inc_mode$mode_cats == "Auto Passenger"))
pd <- ggplot() + geom_bar(aes(x=temp$income_cat, y=(100 * temp$prop), fill=forcats::fct_rev(temp$mode_cats)), stat="identity", colour="white", width = 0.5) +
xlab("Household Income") + ylab("Percent of Trips by Driving (%)") + labs(fill = "Travel Mode") +
scale_x_discrete(labels = rev(c("decline / don't know", "$125k + ","100k - 125k", "$60k - 100k", "40k - 60k", "< 40k" ))) +
theme_minimal() +
theme(axis.text.x = element_text(angle=45, hjust=1))
pd
temp <- subset(b_inc_mode,b_inc_mode$mode_cats == "Bicycle" | b_inc_mode$mode_cats == "Walk")
pa <- ggplot() + geom_bar(aes(x=temp$income_cat, y=(100 * temp$prop), fill=forcats::fct_rev(temp$mode_cats)), stat="identity", colour="white", width = 0.5) +
xlab("Household Income") + ylab("Percent of Trips by Active Modes (%)") + labs(fill = "Travel Mode") +
scale_x_discrete(labels = rev(c("decline / don't know", "$125k + ","100k - 125k", "$60k - 100k", "40k - 60k", "< 40k" ))) +
theme_minimal() +
theme(axis.text.x = element_text(angle=45, hjust=1))
pa
66.8 + 9.7
